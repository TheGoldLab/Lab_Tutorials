
    <html>
      <head>
        <title>Building-a-sample-experiment-Part-2---Target-to-Mouse-wiring</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
      </head>
      <body>
        <div id='content'>
    <p>Building a sample experiment</p>
<p><em>Part 2</em></p>
<pre><code>function drawableMouse()
</code></pre>
<p>In this next section we will be learning how to create an object that can be manipulated by the mouse. Snow Dots has scripts designed to read HID(Human Interface Device) data from a variety of input devices.</p>
<p>This first three lines of code are simply clearing the command window, clearing any variables, and telling the Screen to refresh itself. Most importantly the final line is also telling the Screen to open up in a small window instead of full screen. This is useful for debugging purposes. </p>
<ul>
<li>For reference, 0-debug, 1-full screen, 2-secondary screen.</li>
</ul>
<pre><code>clc;
clear all;
dotsTheScreen.reset('displayIndex', 0);
</code></pre>
<p>First we will create the object that will represent our mouse when the drawing screen is up. </p>
<pre><code>MouseDot = dotsDrawableVertices();
</code></pre>
<p>If we opened a draw screen we'd find a small dot in the center of the screen. Lets increase the size first. </p>
<pre><code>MouseDot.pixelSize = 10;
</code></pre>
<p>Now you should see a white square in the center of your screen. </p>
<pre><code>dotsTheScreen.openWindow;
dotsDrawable.drawFrame({MouseDot});
pause(2);
dotsTheScreen.closeWindow;
</code></pre>
<p>This simple white square will be used to represent the mouse when the drawing window is open.  Of course, we will need to add some additional code to wire together our mouse and this object.</p>
<p>Fortunately for us, Snow Dots can easily read from most input devices. In our case we will be using <a href="https://github.com/TheGoldLab/Lab-Matlab-Control/blob/master/snow-dots/classes/readable/dotsReadableHIDMouse.m">dotsReadableHIDMouse.m</a> Like our visual objects, we must first create an object.</p>
<pre><code>compMouse = dotsReadableHIDMouse();
</code></pre>
<p>If you type the above code into the command window without the semi-colon at the end you can see all the various properties that this function contains and automatically retrieves from the mouse.</p>
<p>Now we will need to wire together the properties of compMouse and our target. We will do this by setting the x and y position of our target equal to the x and y position of compMouse, our object that represents the mouse.  </p>
<p>The first line is simply a method within dotsReadable, the superclass for all readable devices, that tells Matlab to get the newest device data. The second line is a familiar one at this point, we are using a method within dotsDrawable to draw our target. The third and fourth line are setting the x and y position of our target, MouseDot, equal to our mouse object, compMouse. </p>
<pre><code>compMouse.read();    
dotsDrawable.drawFrame({MouseDot});
MouseDot.x = compMouse.x
MouseDot.y = compMouse.y;
</code></pre>
<p>Of course it doesn't do us much good to only have this occur once. The process of reading the mouse needs to be continual, as does the process of updating the target positions. For this we can set up a simple while loop that we can break easily.</p>
<pre><code>while MouseDot.x &lt;= 42

    compMouse.read();    
    dotsDrawable.drawFrame({MouseDot});
    MouseDot.x = compMouse.x;
    MouseDot.y = compMouse.y;
end
</code></pre>
<p>All this loop is doing is saying that for as long as the x-position of our target is below 42,  we will continue to read new data from the mouse, draw our target, and change the x and y position of our target.</p>
<p>Running this code below will let you see the completed process so far.</p>
<pre><code>function drawableMouse()
clc;
clear all;

dotsTheScreen.reset('displayIndex', 0);

MouseDot = dotsDrawableVertices();
MouseDot.pixelSize = 10;

compMouse = dotsReadableHIDMouse();

dotsTheScreen.openWindow;

while MouseDot.x &lt;= 42

    compMouse.read();    
    dotsDrawable.drawFrame({MouseDot});
    MouseDot.x = compMouse.x;
    MouseDot.y = compMouse.y;
end
dotsTheScreen.closeWindow;  
</code></pre>
<p>As you might have noticed, our target moves very aggressively (and our y-postion is inverted). We will need to calibrate our mouse settings to smooth things out a bit. Fortunately Snow Dots provides us with a simple way to achieve this. </p>
<p>This first line is simply setting xAxis (this could be called anything but its easy to see that you are getting the x component) equal to the the first structure in compMouse.components. The 5 component structures of the mouse object (compMouse) are the x-y axis and buttons (the scroll wheel click is the 5th button) on our mouse. The second line is using a built-in Snow Dots method that resides in <a href="https://github.com/TheGoldLab/Lab-Matlab-Control/blob/master/snow-dots/classes/readable/dotsReadableHID.m">dotsReadableHID.m</a>.  The fourth argument is our calibration argument. You can look at dotsReadableHID file directly to find out what other input arguments are available. If you change the 1s to a higher number you will find the target moves smoothly but just a bit faster. This can be useful for fine tuning an experiment.</p>
<pre><code>xAxis = compMouse.components(1);
compMouse.setComponentCalibration(xAxis.ID, [], [], [-1 1]);

yAxis = compMouse.components(2);
compMouse.setComponentCalibration(yAxis.ID, [], [], [-1 1]);
</code></pre>
<p>The final part is simply correcting the y-positioning. To do that we will just add a "-" to compMouse.y.</p>
<p>The final code is posted below. Simply copy and paste that and you will have a working movable target.</p>
<hr />
<pre><code>function drawableMouse()

clc;
clear all;

dotsTheScreen.reset('displayIndex', 0);

MouseDot = dotsDrawableVertices();
MouseDot.pixelSize = 10;

compMouse = dotsReadableHIDMouse();

xAxis = compMouse.components(1);
compMouse.setComponentCalibration(xAxis.ID, [], [], [-1 1]);

yAxis = compMouse.components(2);
compMouse.setComponentCalibration(yAxis.ID, [], [], [-1 1]);

dotsTheScreen.openWindow;

while MouseDot.x &lt;= 42

    compMouse.read();    
    dotsDrawable.drawFrame({MouseDot});
    MouseDot.x = compMouse.x;
    MouseDot.y = -compMouse.y;
end

dotsTheScreen.closeWindow;
</code></pre>
<pre><code>
</code></pre>

        </div>
        <style type='text/css'>body {
  font: 400 16px/1.5 "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #111;
  background-color: #fdfdfd;
  -webkit-text-size-adjust: 100%;
  -webkit-font-feature-settings: "kern" 1;
  -moz-font-feature-settings: "kern" 1;
  -o-font-feature-settings: "kern" 1;
  font-feature-settings: "kern" 1;
  font-kerning: normal;
  padding: 30px;
}

@media only screen and (max-width: 600px) {
  body {
    padding: 5px;
  }

  body > #content {
    padding: 0px 20px 20px 20px !important;
  }
}

body > #content {
  margin: 0px;
  max-width: 900px;
  border: 1px solid #e1e4e8;
  padding: 10px 40px;
  padding-bottom: 20px;
  border-radius: 2px;
  margin-left: auto;
  margin-right: auto;
}

hr {
  color: #bbb;
  background-color: #bbb;
  height: 1px;
  flex: 0 1 auto;
  margin: 1em 0;
  padding: 0;
  border: none;
}

/**
 * Links
 */
a {
  color: #0366d6;
  text-decoration: none; }
  a:visited {
    color: #0366d6; }
  a:hover {
    color: #0366d6;
    text-decoration: underline; }

pre {
  background-color: #f6f8fa;
  border-radius: 3px;
  font-size: 85%;
  line-height: 1.45;
  overflow: auto;
  padding: 16px;
}

/**
  * Code blocks
  */

code {
  background-color: rgba(27,31,35,.05);
  border-radius: 3px;
  font-size: 85%;
  margin: 0;
  word-wrap: break-word;
  padding: .2em .4em;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
}

pre > code {
  background-color: transparent;
  border: 0;
  display: inline;
  line-height: inherit;
  margin: 0;
  overflow: visible;
  padding: 0;
  word-wrap: normal;
  font-size: 100%;
}


/**
 * Blockquotes
 */
blockquote {
  margin-left: 30px;
  margin-top: 0px;
  margin-bottom: 16px;
  border-left-width: 3px;
  padding: 0 1em;
  color: #828282;
  border-left: 4px solid #e8e8e8;
  padding-left: 15px;
  font-size: 18px;
  letter-spacing: -1px;
  font-style: italic;
}
blockquote * {
  font-style: normal !important;
  letter-spacing: 0;
  color: #6a737d !important;
}

/**
 * Tables
 */
table {
  border-spacing: 2px;
  display: block;
  font-size: 14px;
  overflow: auto;
  width: 100%;
  margin-bottom: 16px;
  border-spacing: 0;
  border-collapse: collapse;
}

td {
  padding: 6px 13px;
  border: 1px solid #dfe2e5;
}

th {
  font-weight: 600;
  padding: 6px 13px;
  border: 1px solid #dfe2e5;
}

tr {
  background-color: #fff;
  border-top: 1px solid #c6cbd1;
}

table tr:nth-child(2n) {
  background-color: #f6f8fa;
}

/**
 * Others
 */

img {
  max-width: 100%;
}

p {
  line-height: 24px;
  font-weight: 400;
  font-size: 16px;
  color: #24292e; }

ul {
  margin-top: 0; }

li {
  color: #24292e;
  font-size: 16px;
  font-weight: 400;
  line-height: 1.5; }

li + li {
  margin-top: 0.25em; }

* {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  color: #24292e; }

a:visited {
  color: #0366d6; }

h1, h2, h3 {
  border-bottom: 1px solid #eaecef;
  color: #111;
  /* Darker */ }</style>
      </body>
    </html>